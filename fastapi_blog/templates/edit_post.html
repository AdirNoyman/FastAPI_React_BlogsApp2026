{% extends "layout.html" %}

{% block content %}
<!-- Breadcrumb Navigation -->
<div style="margin-bottom: 24px;">
    <div style="display: flex; align-items: center; gap: 8px; font-size: 13px; color: var(--text-secondary);">
        <a href="/" style="color: var(--text-secondary); text-decoration: none; transition: color var(--transition-fast);"
           onmouseover="this.style.color='var(--text-primary)'"
           onmouseout="this.style.color='var(--text-secondary)'">Home</a>
        <i data-lucide="chevron-right" style="width: 14px; height: 14px;"></i>
        <a href="/posts/{{ post.id }}" style="color: var(--text-secondary); text-decoration: none; transition: color var(--transition-fast);"
           onmouseover="this.style.color='var(--text-primary)'"
           onmouseout="this.style.color='var(--text-secondary)'">{{ post.title[:40] }}{% if post.title|length > 40 %}...{% endif %}</a>
        <i data-lucide="chevron-right" style="width: 14px; height: 14px;"></i>
        <span style="color: var(--text-muted);">Edit</span>
    </div>
</div>

<!-- Edit Form Card -->
<div class="form-container animate-in">
    <div class="form-card">
        <!-- Form Header -->
        <div class="form-header">
            <div>
                <h1 style="font-size: 24px; font-weight: 700; color: var(--text-primary); margin-bottom: 8px;">
                    Edit Post
                </h1>
                <p style="font-size: 14px; color: var(--text-secondary);">
                    Update your blog post content below
                </p>
            </div>
        </div>

        <!-- Edit Form -->
        <form id="editForm" method="POST" action="/posts/{{ post.id }}" onsubmit="return validateForm()">
            <!-- Title Field -->
            <div class="form-group">
                <label for="title" class="form-label">
                    Post Title
                    <span style="color: var(--accent-red);">*</span>
                </label>
                <input
                    type="text"
                    id="title"
                    name="title"
                    class="form-input"
                    value="{{ post.title }}"
                    maxlength="200"
                    required
                    placeholder="Enter a compelling title..."
                >
                <div class="form-hint">Maximum 200 characters</div>
            </div>

            <!-- Author Field -->
            <div class="form-group">
                <label for="author" class="form-label">
                    Author Name
                    <span style="color: var(--accent-red);">*</span>
                </label>
                <input
                    type="text"
                    id="author"
                    name="author"
                    class="form-input"
                    value="{{ post.author }}"
                    maxlength="100"
                    required
                    placeholder="Your name"
                >
                <div class="form-hint">Maximum 100 characters</div>
            </div>

            <!-- Content Field -->
            <div class="form-group">
                <label for="content" class="form-label">
                    Post Content
                    <span style="color: var(--accent-red);">*</span>
                </label>
                <textarea
                    id="content"
                    name="content"
                    class="form-textarea"
                    rows="10"
                    required
                    placeholder="Write your post content here..."
                    oninput="updateCharCounter()"
                >{{ post.content }}</textarea>
                <div class="form-hint">
                    <span id="charCount">0</span> characters
                </div>
            </div>

            <!-- Form Actions -->
            <div class="form-actions">
                <a href="/posts/{{ post.id }}" class="btn-secondary" style="text-decoration: none;">
                    <i data-lucide="x" style="width: 16px; height: 16px;"></i>
                    Cancel
                </a>
                <button type="submit" class="btn-primary">
                    <i data-lucide="save" style="width: 16px; height: 16px;"></i>
                    Save Changes
                </button>
            </div>
        </form>
    </div>
</div>

<script>
    // Update character counter
    function updateCharCounter() {
        const textarea = document.getElementById('content');
        const charCount = document.getElementById('charCount');
        charCount.textContent = textarea.value.length;
    }

    // Initialize character counter on page load
    updateCharCounter();

    // Form validation
    function validateForm() {
        const title = document.getElementById('title').value.trim();
        const author = document.getElementById('author').value.trim();
        const content = document.getElementById('content').value.trim();

        if (!title || !author || !content) {
            alert('Please fill in all required fields.');
            return false;
        }

        if (title.length > 200) {
            alert('Title must be 200 characters or less.');
            return false;
        }

        if (author.length > 100) {
            alert('Author name must be 100 characters or less.');
            return false;
        }

        return true;
    }

    // Re-initialize Lucide icons
    lucide.createIcons();
</script>
{% endblock %}
